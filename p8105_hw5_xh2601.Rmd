---
title: "p8105_hw5_xh2601"
output: github_document
---

```{r setup, message = FALSE}
# load the tidyverse library
library(tidyverse)
```

The general format for plots making

```{r}
knitr::opts_chunk$set(
  fig.width = 6,
  fig.asp = .6,
  out.width = "90%"
)

theme_set(
  theme_minimal() + 
    theme(legend.position = "bottom",
          plot.title = element_text(hjust = 0.5))
)

options(
  ggplot2.continuous.colour = "viridis",
  ggplot2.continuous.fill = "viridis"
)

scale_colour_discrete = scale_colour_viridis_d
scale_fill_discrete = scale_fill_viridis_d
```

## Problem 1

Write a function that randomly draws “birthdays” for each person; checks whether there are duplicate birthdays in the group; and returns TRUE or FALSE based on the result.

```{r}
# the function takes group size 'n_room' as a parameter
bday_sim = function(n_room) {
  # randomly draw n_room samples from the range 1-365, with replacement
  birthdays = sample(1:365, n_room, replace = TRUE)
  # if the length of unique birthdays is less than the group size, then there are repeated birthdays
  repeated_bday = length(unique(birthdays)) < n_room
  # return TRUE or FALSE
  repeated_bday
}
```

Run this function 10000 times for each group size between 2 and 50. For each group size, compute the probability that at least two people in the group will share a birthday by averaging across the 10000 simulation runs. Make a plot showing the probability as a function of group size, and comment on your results.

```{r}
# use expand_grid() to create a dataframe for group size ranged 2-50, each has 10000 times iteration
# use map() to call bday_sim() fuction with each group size for 10000 times
# use mutate() to store the result from map()
# group by group size
# create a summarize dataframe to show the mean probability of having repeated birthdays for each group size
bday_sim_results = 
  expand_grid(
    group_sz = 2:50,
    iter = 1:10000
  ) |> 
  mutate(
    result = map_lgl(group_sz, bday_sim)
  ) |> 
  group_by(group_sz) |> 
  summarize(
    prob_repeat = mean(result)
  )

# make a dot point, with x-axis being group size, y-axis being the probability
bday_sim_results |> 
  ggplot(aes(x = group_sz, y = prob_repeat)) +
  geom_point() +
  geom_line() +
  labs(title = "Probability of Shared Birthdays Across Group Size", x = "Group Size", y = "Probability of Repeated Birthdays") +
  scale_y_continuous(
    labels = scales::label_percent(scale = 100))
```

Based on the plot, in group size between 2 to 50, the probability of at least two people sharing a birthday follows a S-shaped curve. The probability is approaching 0% when the group size is 2; it is above 50% when group size is larger than or equals to 23 people; and it approaches 100% when the group size gets larger. The probability of at least two people sharing a birthday among 50 people is very high.






